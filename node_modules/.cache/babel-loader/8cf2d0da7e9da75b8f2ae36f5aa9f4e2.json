{"ast":null,"code":"import _slicedToArray from\"/Users/anismedini/Desktop/code-js/github-job/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/anismedini/Desktop/code-js/github-job/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{useReducer,useEffect}from'react';import axios from'axios';var ACTIONS={MAKE_REQUEST:'make-request',GET_DATA:'get-data',ERROR:'error',UPDATE_HAS_NEXT_PAGE:'update-has-next-page'};var BASE_URL=\"https://cors-anywhere.herokuapp.com/https://jobs.github.com/positions.json\";function reducer(state,action){switch(action.type){case ACTIONS.MAKE_REQUEST:return{loading:true,jobs:[]};case ACTIONS.GET_DATA:return _objectSpread({},state,{loading:false,jobs:action.payload.jobs});case ACTIONS.ERROR:return _objectSpread({},state,{loading:false,error:action.payload.error,jobs:[]});case ACTIONS.UPDATE_HAS_NEXT_PAGE:return _objectSpread({},state,{hasNextPage:action.payload.hasNextPage});default:return state;}}export default function useFetchJobs(params,page){var _useReducer=useReducer(reducer,{jobs:[],loading:true}),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispach=_useReducer2[1];useEffect(function(){var cancelToken1=axios.CancelToken.source;dispach({type:ACTIONS.MAKE_REQUEST});axios.get(BASE_URL,{cancelToken:cancelToken1.token,params:_objectSpread({markdown:true,page:page},params)}).then(function(res){dispach({type:ACTIONS.GET_DATA,payload:{jobs:res.data}});}).catch(function(e){if(axios.isCancel(e))return;dispach({type:ACTIONS.ERROR,payload:{error:e}});});var cancelToken2=axios.CancelToken.source;axios.get(BASE_URL,{cancelToken:cancelToken2.token,params:_objectSpread({markdown:true,page:page+1},params)}).then(function(res){dispach({type:ACTIONS.UPDATE_HAS_NEXT_PAGE,payload:{hasNextPage:res.data.length!==0}});}).catch(function(e){if(axios.isCancel(e))return;dispach({type:ACTIONS.ERROR,payload:{error:e}});});// don't know why it's not working\n// return () => {\n//     cancelToken1.cancel();\n//    cancelToken2.cancel();\n// }\n},[params,page]);return state;}","map":{"version":3,"sources":["/Users/anismedini/Desktop/code-js/github-job/src/useFetchJobs.js"],"names":["useReducer","useEffect","axios","ACTIONS","MAKE_REQUEST","GET_DATA","ERROR","UPDATE_HAS_NEXT_PAGE","BASE_URL","reducer","state","action","type","loading","jobs","payload","error","hasNextPage","useFetchJobs","params","page","dispach","cancelToken1","CancelToken","source","get","cancelToken","token","markdown","then","res","data","catch","e","isCancel","cancelToken2","length"],"mappings":"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","sourcesContent":["\nimport {useReducer, useEffect} from 'react'\nimport axios from 'axios'\n\nconst ACTIONS = {\n    MAKE_REQUEST: 'make-request', \n    GET_DATA: 'get-data',\n    ERROR:'error',\n    UPDATE_HAS_NEXT_PAGE: 'update-has-next-page'\n}\nconst BASE_URL= \"https://cors-anywhere.herokuapp.com/https://jobs.github.com/positions.json\";\n\nfunction reducer(state , action) {\n    switch (action.type) {\n        case ACTIONS.MAKE_REQUEST:\n            return {loading: true, jobs:[]}\n        case ACTIONS.GET_DATA:\n            return {...state,loading:false,jobs:action.payload.jobs}\n        case ACTIONS.ERROR:\n           return {...state,loading:false,error:action.payload.error,jobs:[]}\n        case ACTIONS.UPDATE_HAS_NEXT_PAGE :\n            return {...state, hasNextPage: action.payload.hasNextPage} \n        default:\n            return state;\n    }\n}\nexport default function useFetchJobs(params, page) {\n    const [state, dispach] = useReducer(reducer, {jobs:[],loading:true,})\n\n    useEffect(()=>{\n        const cancelToken1 =axios.CancelToken.source\n            dispach({type:ACTIONS.MAKE_REQUEST})\n            axios.get(BASE_URL,{\n                cancelToken: cancelToken1.token,\n                params: {markdown: true, page:page,...params}\n            }).then(res =>{\n                dispach({type:ACTIONS.GET_DATA, payload:{jobs:res.data}})\n            }).catch (e=>{\n                if(axios.isCancel(e)) return;\n                dispach({type: ACTIONS.ERROR, payload:{error: e}})\n            })\n\n\n            const cancelToken2 =axios.CancelToken.source\n            axios.get(BASE_URL,{\n                cancelToken: cancelToken2.token,\n                params: {markdown: true, page:page +1,...params}\n            }).then(res =>{\n                dispach({type:ACTIONS.UPDATE_HAS_NEXT_PAGE, payload:{hasNextPage:res.data.length !==0}})\n            }).catch (e=>{\n                if(axios.isCancel(e)) return;\n                dispach({type: ACTIONS.ERROR, payload:{error: e}})\n            })\n\n            // don't know why it's not working\n            // return () => {\n            //     cancelToken1.cancel();\n            //    cancelToken2.cancel();\n            // }\n            \n\n\n    },[params,page])\n\n    return state\n\n    \n\n}"]},"metadata":{},"sourceType":"module"}